import{d as l,_ as T,i as u,l as h,q as s,z as t,b as S,D as L,g as p,h as O,c as d}from"./q-BrAWZM5D.js";import{p as _}from"./q-C2EB_Z9y.js";import{_ as n}from"./q-DoNi8vyY.js";import{R as P}from"./q-f5n4dq3A.js";const A=async o=>{const[a]=l();if(confirm("Sei sicuro di voler eliminare questo task?"))try{await _.collection("task_admin").delete(o),await a()}catch{alert("Errore nell'eliminazione del task")}},C=Object.freeze(Object.defineProperty({__proto__:null,_hW:d,s_eSgrt040BRA:A},Symbol.toStringTag,{value:"Module"})),j=()=>{const[o,a]=l();return o(a)},E=Object.freeze(Object.defineProperty({__proto__:null,s_EyrokO1qYCo:j},Symbol.toStringTag,{value:"Module"})),I=o=>{T();const a=u([]),r=u(!0),i=u(!1),g=u(null),c=s(()=>n(()=>Promise.resolve().then(()=>G),void 0),"s_U7Gtvxqg5eI",[r,a]);h(s(()=>n(()=>Promise.resolve().then(()=>V),void 0),"s_0Eq5pHw5aHw",[c]));const b=s(()=>n(()=>Promise.resolve().then(()=>F),void 0),"s_iF5Su0pCqYY",[c]),x=s(()=>n(()=>Promise.resolve().then(()=>C),void 0),"s_eSgrt040BRA",[c]),v=s(()=>n(()=>Promise.resolve().then(()=>Y),void 0),"s_xyZW3vC107I",[i,g]),y=e=>{switch(e){case"urgente":return"bg-red-100 text-red-600 dark:bg-red-900/20 dark:text-red-400";case"alta":return"bg-orange-100 text-orange-600 dark:bg-orange-900/20 dark:text-orange-400";case"media":return"bg-blue-100 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400";case"bassa":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}},k=e=>{switch(e){case"urgente":return"ðŸ”´";case"alta":return"ðŸŸ ";case"media":return"ðŸ”µ";case"bassa":return"âšª";default:return"âšª"}},f=e=>{switch(e){case"completato":return"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-400";case"in_corso":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";case"bloccato":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400";case"aperto":return"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"}};return r.value?t("div",null,{class:"space-y-3"},[1,2,3].map(e=>t("div",null,{class:"h-16 bg-gray-50 dark:bg-gray-800 rounded-xl animate-pulse"},null,3,e)),1,"Ce_0"):a.value.length===0?t("div",null,{class:"text-center py-12"},[t("div",null,{class:"text-5xl mb-4"},"âœ“",3,null),t("p",null,{class:"text-gray-400 font-bold text-sm"},"Nessun task in sospeso",3,null)],3,"Ce_1"):t("div",null,{class:"space-y-3 max-h-[500px] overflow-y-auto custom-scrollbar"},[a.value.map(e=>{var m;return t("div",{class:`group flex items-start gap-4 p-4 rounded-xl border transition-all ${e.completato?"bg-gray-50/50 dark:bg-gray-800/30 border-gray-200 dark:border-gray-700 opacity-60":e.in_evidenza?"bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-800 shadow-sm":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:shadow-md"}`},null,[e.in_evidenza&&!e.completato&&t("div",null,{class:"absolute top-2 right-2 text-xs"},"ðŸ“Œ",3,"Ce_2"),t("button",{class:`flex-shrink-0 w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${e.completato?"bg-emerald-500 border-emerald-500":"border-gray-300 dark:border-gray-600 hover:border-emerald-400"}`,onClick$:s(()=>n(()=>Promise.resolve().then(()=>q),void 0),"s_oh42BFfSP3I",[e,b])},null,e.completato&&t("span",null,{class:"text-white text-sm"},"âœ“",3,"Ce_3"),0,null),t("div",null,{class:"flex-1 min-w-0"},[t("div",null,{class:"flex items-start justify-between gap-3"},[t("div",null,{class:"flex-1"},[t("p",{class:`text-sm font-bold ${e.completato?"line-through text-gray-400":"text-gray-900 dark:text-gray-100"}`},null,e.titolo||"Senza Titolo",1,null),(e.contenuto||e.descrizione_breve)&&t("p",null,{class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"},e.descrizione_breve||e.contenuto,1,"Ce_4"),((m=e.expand)==null?void 0:m.assegnato_a_id)&&t("p",null,{class:"text-[10px] text-gray-400 mt-1"},["ðŸ‘¤ ",e.expand.assegnato_a_id.name||e.expand.assegnato_a_id.email],1,"Ce_5")],1,null),t("div",null,{class:"flex flex-col items-end gap-1"},[t("span",{class:`px-2 py-1 rounded-lg text-[10px] font-black uppercase tracking-wider ${y(e.priorita||"media")}`},null,[k(e.priorita||"media")," ",e.priorita||"media"],1,null),e.stato&&e.stato!=="aperto"&&t("span",{class:`px-2 py-0.5 rounded text-[9px] font-bold ${f(e.stato)}`},null,L(e,"stato"),1,"Ce_6")],1,null)],1,null),e.data_riferimento&&t("p",null,{class:"text-[10px] text-gray-400 mt-2"},["ðŸ“… ",new Date(e.data_riferimento).toLocaleDateString("it-IT")],1,"Ce_7"),e.promemoria_inviato&&t("p",null,{class:"text-[10px] text-emerald-600 dark:text-emerald-400 mt-1"},"âœ‰ï¸ Promemoria inviato",3,"Ce_8"),t("div",null,{class:"flex items-center gap-2 mt-3 opacity-0 group-hover:opacity-100 transition-opacity"},[t("button",{onClick$:s(()=>n(()=>Promise.resolve().then(()=>E),void 0),"s_EyrokO1qYCo",[v,e])},{class:"px-3 py-1.5 bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400 rounded-lg text-xs font-bold hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",title:"Invia promemoria via email"},"ðŸ“§ Sollecita",2,null),t("button",{onClick$:s(()=>n(()=>Promise.resolve().then(()=>W),void 0),"s_NqOogLA7ge0",[x,e])},{class:"px-3 py-1.5 bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 rounded-lg text-xs font-bold hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors"},"ðŸ—‘ï¸ Elimina",2,null)],1,null)],1,null)],1,e.id)}),S(P,{get isOpen(){return i.value},get task(){return g.value},onClose$:s(()=>n(()=>Promise.resolve().then(()=>w),void 0),"s_qMthlahGvkA",[i]),onSent$:s(()=>n(()=>Promise.resolve().then(()=>N),void 0),"s_PCzgjmycFe0",[c]),[O]:{isOpen:p(e=>e.value,[i]),task:p(e=>e.value,[g])}},2,"Ce_9")],1,"Ce_10")},J=Object.freeze(Object.defineProperty({__proto__:null,s_4POcaaixRjI:I},Symbol.toStringTag,{value:"Module"})),M=()=>{const[o]=l();return o.value=!1},w=Object.freeze(Object.defineProperty({__proto__:null,_hW:d,s_qMthlahGvkA:M},Symbol.toStringTag,{value:"Module"})),R=()=>{const[o,a]=l();return a(o.id,o.completato)},q=Object.freeze(Object.defineProperty({__proto__:null,s_oh42BFfSP3I:R},Symbol.toStringTag,{value:"Module"})),z=()=>{const[o]=l();o()},V=Object.freeze(Object.defineProperty({__proto__:null,_hW:d,s_0Eq5pHw5aHw:z},Symbol.toStringTag,{value:"Module"})),D=async(o,a)=>{const[r]=l();try{const i=!a;await _.collection("task_admin").update(o,{completato:i,stato:i?"completato":"aperto"}),await r()}catch{alert("Errore nell'aggiornamento del task")}},F=Object.freeze(Object.defineProperty({__proto__:null,_hW:d,s_iF5Su0pCqYY:D},Symbol.toStringTag,{value:"Module"})),$=o=>{const[a,r]=l();r.value=o,a.value=!0},Y=Object.freeze(Object.defineProperty({__proto__:null,_hW:d,s_xyZW3vC107I:$},Symbol.toStringTag,{value:"Module"})),B=async()=>{const[o,a]=l();o.value=!0;try{console.log("[AdminTaskList] Fetching tasks from task_admin..."),console.log("[AdminTaskList] Auth state:",{isValid:_.authStore.isValid,token:_.authStore.token?"EXISTS":"MISSING"});const r=await _.collection("task_admin").getFullList({requestKey:null,expand:"assegnato_a_id"});console.log("[AdminTaskList] âœ… Fetched tasks:",r.length),r.length>0&&console.log("[AdminTaskList] First task:",r[0]),a.value=r}catch(r){console.error("[AdminTaskList] âŒ Error fetching tasks:",{message:r.message,status:r.status,data:r.data}),a.value=[]}finally{o.value=!1}},G=Object.freeze(Object.defineProperty({__proto__:null,_hW:d,s_U7Gtvxqg5eI:B},Symbol.toStringTag,{value:"Module"})),H=()=>{const[o]=l();return o()},N=Object.freeze(Object.defineProperty({__proto__:null,_hW:d,s_PCzgjmycFe0:H},Symbol.toStringTag,{value:"Module"})),U=()=>{const[o,a]=l();return o(a.id)},W=Object.freeze(Object.defineProperty({__proto__:null,s_NqOogLA7ge0:U},Symbol.toStringTag,{value:"Module"}));export{d as _hW,J as a,z as s_0Eq5pHw5aHw,I as s_4POcaaixRjI,j as s_EyrokO1qYCo,U as s_NqOogLA7ge0,H as s_PCzgjmycFe0,B as s_U7Gtvxqg5eI,A as s_eSgrt040BRA,D as s_iF5Su0pCqYY,R as s_oh42BFfSP3I,M as s_qMthlahGvkA,$ as s_xyZW3vC107I};
