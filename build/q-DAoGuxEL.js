import{d as m,_ as E,i as y,l as S,q as _,z as l,b as s,h as e,g as u,c as f}from"./q-BrAWZM5D.js";import{p}from"./q-C2EB_Z9y.js";import{_ as b}from"./q-DoNi8vyY.js";import{_auto_StatCard as v,_auto_ActionButton as h}from"./q-C9yB8BVn.js";import{A as I,T as K}from"./q-BnXxJfM1.js";const M=async()=>{const[t,i]=m();i.value=!0;try{const[a,n,d,g]=await Promise.allSettled([p.collection("tecniche").getFullList({requestKey:null}),p.collection("dizionario").getList(1,1,{requestKey:null}),p.collection("galleria").getList(1,1,{requestKey:null}),p.collection("bacheca").getList(1,1,{requestKey:null})]),o=a.status==="fulfilled"?a.value:[],O=n.status==="fulfilled"?n.value:{totalItems:0},k=d.status==="fulfilled"?d.value:{totalItems:0},T=g.status==="fulfilled"?g.value:{totalItems:0},x={};o.forEach(c=>{const r=(c.tags||"Altro").split(",")[0].trim();x[r]=(x[r]||0)+1});const L=Object.entries(x).map(([c,r])=>({name:c,count:r}));t.value={techniques:o.length,dictionary:O.totalItems,gallery:k.totalItems,posts:T.totalItems,categories:L.sort((c,r)=>r.count-c.count)}}catch(a){console.error("[Dashboard] Error fetching stats:",a)}finally{i.value=!1}},j=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_LmTZO0E8YpE:M},Symbol.toStringTag,{value:"Module"})),w=()=>{const[t]=m();t()},A=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_sm0uKnYcFps:w},Symbol.toStringTag,{value:"Module"})),G=()=>{E();const t=y({techniques:0,dictionary:0,gallery:0,posts:0,categories:[]}),i=y(!0),a=y(!1),n=_(()=>b(()=>Promise.resolve().then(()=>j),void 0),"s_LmTZO0E8YpE",[t,i]);S(_(()=>b(()=>Promise.resolve().then(()=>A),void 0),"s_sm0uKnYcFps",[n]));const d=_(()=>b(()=>Promise.resolve().then(()=>C),void 0),"s_JzLWdWOC0OE",[a]),g=_(()=>b(()=>Promise.resolve().then(()=>z),void 0),"s_HIs30gdvGfI",[a]);return l("div",null,{class:"space-y-10 animate-in fade-in duration-700"},[l("header",null,null,[l("h2",null,{class:"text-4xl font-black text-gray-900 dark:text-white tracking-tight"},["Benvenuto, ",l("span",null,{class:"text-red-600"},"Sensei",3,null)],3,null),l("p",null,{class:"mt-2 text-gray-500 dark:text-gray-400 font-medium"},"Ecco cosa sta succedendo nel Dojo oggi.",3,null)],3,null),i.value?l("div",null,{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},[1,2,3,4].map(o=>l("div",null,{class:"h-32 bg-white dark:bg-gray-900 rounded-3xl animate-pulse"},null,3,o)),1,"KG_0"):l("div",null,{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},[s(v,{label:"Tecniche",get value(){return t.value.techniques},icon:"ðŸ¥‹",color:"red",[e]:{label:e,value:u(o=>o.value.techniques,[t]),icon:e,color:e}},3,"KG_1"),s(v,{label:"Termini",get value(){return t.value.dictionary},icon:"ðŸ“š",color:"blue",[e]:{label:e,value:u(o=>o.value.dictionary,[t]),icon:e,color:e}},3,"KG_2"),s(v,{label:"Media",get value(){return t.value.gallery},icon:"ðŸ–¼ï¸",color:"green",[e]:{label:e,value:u(o=>o.value.gallery,[t]),icon:e,color:e}},3,"KG_3"),s(v,{label:"News",get value(){return t.value.posts},icon:"ðŸ“°",color:"yellow",[e]:{label:e,value:u(o=>o.value.posts,[t]),icon:e,color:e}},3,"KG_4")],1,null),l("div",null,{class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},[l("div",null,{class:"lg:col-span-2 bg-white dark:bg-gray-900 rounded-3xl border border-gray-100 dark:border-gray-800 p-8 shadow-sm"},[l("div",null,{class:"flex items-center justify-between mb-8"},[l("div",null,{class:"flex items-center gap-3"},[l("div",null,{class:"w-10 h-10 rounded-xl bg-red-50 dark:bg-red-900/20 flex items-center justify-center"},l("span",null,{class:"text-xl"},"âœ“",3,null),3,null),l("div",null,null,[l("h3",null,{class:"text-xl font-black text-gray-900 dark:text-white tracking-tight"},"Task Amministrativi",3,null),l("p",null,{class:"text-xs text-gray-400 font-medium"},"Gestisci le attivitÃ  del Dojo",3,null)],3,null)],3,null),l("div",null,{class:"flex gap-2"},[l("button",null,{class:"px-3 py-2 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl text-xs font-bold hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Ricarica task",onClick$:n},"ðŸ”„",3,null),l("button",null,{class:"px-4 py-2 bg-red-600 text-white rounded-xl text-xs font-bold hover:bg-red-700 transition-colors",onClick$:d},"âž• Nuovo Task",3,null)],3,null)],3,null),s(I,{onRefresh:n,[e]:{onRefresh:e}},3,"KG_5")],1,null),l("div",null,{class:"bg-gray-900 rounded-3xl p-8 text-white shadow-xl shadow-gray-950/20"},[l("h3",null,{class:"text-xl font-black mb-8 tracking-tight"},"Azioni Rapide",3,null),l("div",null,{class:"grid grid-cols-1 gap-4"},[s(h,{label:"Aggiungi Tecnica",icon:"ðŸ¥‹",href:"/gestione/tecniche/new",primary:!0,[e]:{label:e,icon:e,href:e,primary:e}},3,"KG_6"),s(h,{label:"Nuovo Termine",icon:"ðŸ“š",href:"/gestione/dizionario/new",[e]:{label:e,icon:e,href:e}},3,"KG_7"),s(h,{label:"Aggiungi Galleria",icon:"ðŸ–¼ï¸",href:"/gestione/gallery/new",[e]:{label:e,icon:e,href:e}},3,"KG_8"),s(h,{label:"Nuovo Post",icon:"âœï¸",href:"/gestione/bacheca/new",[e]:{label:e,icon:e,href:e}},3,"KG_9")],1,null)],1,null)],1,null),s(K,{get isOpen(){return a.value},onClose:g,onTaskCreated:n,[e]:{isOpen:u(o=>o.value,[a]),onClose:e,onTaskCreated:e}},3,"KG_10")],1,"KG_11")},V=Object.freeze(Object.defineProperty({__proto__:null,s_0IZLMAaLBqY:G},Symbol.toStringTag,{value:"Module"})),P=()=>{const[t]=m();t.value=!0},C=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_JzLWdWOC0OE:P},Symbol.toStringTag,{value:"Module"})),q=()=>{const[t]=m();t.value=!1},z=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_HIs30gdvGfI:q},Symbol.toStringTag,{value:"Module"}));export{f as _hW,V as i,G as s_0IZLMAaLBqY,q as s_HIs30gdvGfI,P as s_JzLWdWOC0OE,M as s_LmTZO0E8YpE,w as s_sm0uKnYcFps};
