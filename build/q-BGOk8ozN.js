import{_auto_COLS as b,_auto_ROWS as y,_auto_SoundFX as w,useTechniquesData as G,_auto_Joystick as N,_auto_TETROMINOES as C,_auto_GOKYO_GROUPS as Y}from"./q-DmmzrV6J.js";import{d as g,_ as K,y as F,i as h,m as O,l as S,q as m,z as o,g as v,b as Q,h as k,c as x}from"./q-BrAWZM5D.js";import{_ as f}from"./q-DoNi8vyY.js";import{A as W}from"./q-D5fsNSdl.js";import{u as B}from"./q-CLNnGxoW.js";const U=(e,n,t,l)=>{for(let i=0;i<e.length;i++)for(let c=0;c<e[i].length;c++)if(e[i][c]&&(t+c<0||t+c>=b||n+i>=y||l[n+i]&&l[n+i][t+c]))return!1;return!0},J=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_RAVO7De0lxE:U},Symbol.toStringTag,{value:"Module"})),X=()=>{const[e,n]=g(),t=e.value;if(!t)return;const l=t.getContext("2d");if(!l)return;l.clearRect(0,0,t.width,t.height);const i=t.width/b,c=t.height/y;l.fillStyle="rgba(0,0,0,0.4)",l.fillRect(0,0,t.width,t.height),l.strokeStyle="#ddd",l.lineWidth=.5,l.beginPath();for(let a=0;a<=b;a++)l.moveTo(a*i,0),l.lineTo(a*i,t.height);for(let a=0;a<=y;a++)l.moveTo(0,a*c),l.lineTo(t.width,a*c);l.stroke();for(let a=0;a<y;a++)for(let r=0;r<b;r++)n.playfield[a][r]&&(l.fillStyle=n.playfield[a][r],l.fillRect(r*i+1,a*c+1,i-2,c-2));n.currentTetromino&&(l.fillStyle=n.currentTetromino.color,n.currentTetromino.matrix.forEach((a,r)=>{a.forEach((u,s)=>{u&&l.fillRect((n.currentTetromino.col+s)*i+1,(n.currentTetromino.row+r)*c+1,i-2,c-2)})}))},H=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_jLcSz3xtGBc:X},Symbol.toStringTag,{value:"Module"})),Z=async()=>{const[e,n,t]=g(),l=await t(e.currentTetromino.matrix);await n(l,e.currentTetromino.row,e.currentTetromino.col,e.playfield)&&(e.currentTetromino.matrix=l,w.rotate())},$=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_fP8Vgcsq5Bs:Z},Symbol.toStringTag,{value:"Module"})),ee=()=>{const[e]=g(),n=["I","J","L","O","S","Z","T"];for(;n.length;){const t=Math.floor(Math.random()*n.length),l=n.splice(t,1)[0];e.tetrominoSequence.push(l)}},te=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_el01Rh6rz00:ee},Symbol.toStringTag,{value:"Module"})),oe=({track:e,cleanup:n})=>{const[t,l,i,c,a,r]=g();e(()=>r.value),e(()=>a.value);const u=s=>{!r.value||a.value||(s.key==="ArrowLeft"?l():s.key==="ArrowRight"?i():s.key==="ArrowUp"?c():s.key==="ArrowDown"&&t())};window.addEventListener("keydown",u),n(()=>window.removeEventListener("keydown",u))},le=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_1eiAyh0j7U0:oe},Symbol.toStringTag,{value:"Module"})),ne=({track:e,cleanup:n})=>{const[t,l,i,c,a]=g();e(()=>i.value);const r=async()=>{if(i.value){if(l.count++,l.count>=l.gameSpeed){l.count=0;const u=l.currentTetromino.row+1;await c(l.currentTetromino.matrix,u,l.currentTetromino.col,l.playfield)?l.currentTetromino.row=u:await a()}await t(),l.requestId=requestAnimationFrame(r)}};i.value&&(l.requestId=requestAnimationFrame(r)),n(()=>{l.requestId&&cancelAnimationFrame(l.requestId)})},re=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_uQEGtKH23FI:ne},Symbol.toStringTag,{value:"Module"})),ae=e=>{const[n,t,l]=g();e>=4?l.ippon++:e>=2?l.waza++:l.yuko++,t.value=Math.min(t.value+1,10),n.gameSpeed=Math.max(5,35-t.value*2)},se=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_K1oWgheaAWg:ae},Symbol.toStringTag,{value:"Module"})),ie=()=>{const[e]=g();return e("/")},ce=Object.freeze(Object.defineProperty({__proto__:null,s_A6IyCQ8FTmg:ie},Symbol.toStringTag,{value:"Module"})),ue=async()=>{const[e,n]=g(),t=e.currentTetromino.col+1;await n(e.currentTetromino.matrix,e.currentTetromino.row,t,e.playfield)&&(e.currentTetromino.col=t,w.move())},_e=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_84n07CVa0mw:ue},Symbol.toStringTag,{value:"Module"})),de=()=>{const[e,n]=g(),t=n.value;if(!t||!e.nextTetromino)return;const l=t.getContext("2d");if(!l)return;l.clearRect(0,0,t.width,t.height);const{matrix:i,color:c}=e.nextTetromino,a=12,r=(t.width-i[0].length*a)/2,u=(t.height-i.length*a)/2;l.fillStyle=c,i.forEach((s,_)=>{s.forEach((p,P)=>{p&&l.fillRect(r+P*a,u+_*a,a-1,a-1)})})},me=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_a9pNKgRJGHg:de},Symbol.toStringTag,{value:"Module"})),fe=e=>{const n=e.length-1;return e.map((t,l)=>t.map((i,c)=>e[n-c][l]))},ge=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_vNVkVuqtQ54:fe},Symbol.toStringTag,{value:"Module"})),pe=()=>{K();const e=G(),n=B(),t=F(W),l=h(),i=h(),c=h(!1),a=h(!1),r=O({ippon:0,waza:0,yuko:0}),u=h(1),s=O({name:"",kanji:"",image:""}),_=h(!1);S(m(()=>f(()=>Promise.resolve().then(()=>Ae),void 0),"s_rwlw60gLUfE",[t]));const p=O({playfield:[],tetrominoSequence:[],currentTetromino:null,nextTetromino:null,count:0,gameSpeed:35,requestId:0}),j=m(()=>f(()=>Promise.resolve().then(()=>Ve),void 0),"s_QsZ56tfQOvY",[e,p,m(()=>f(()=>Promise.resolve().then(()=>te),void 0),"s_el01Rh6rz00",[p])]),V=m(()=>f(()=>Promise.resolve().then(()=>ge),void 0),"s_vNVkVuqtQ54"),T=m(()=>f(()=>Promise.resolve().then(()=>J),void 0),"s_RAVO7De0lxE"),E=m(()=>f(()=>Promise.resolve().then(()=>me),void 0),"s_a9pNKgRJGHg",[p,i]),D=m(()=>f(()=>Promise.resolve().then(()=>Se),void 0),"s_uRuNYoAq4dI",[s,E,p,j,_,m(()=>f(()=>Promise.resolve().then(()=>ke),void 0),"s_0DpCYMKNlc4",[p,a,c]),m(()=>f(()=>Promise.resolve().then(()=>se),void 0),"s_K1oWgheaAWg",[p,u,r])]),L=m(()=>f(()=>Promise.resolve().then(()=>H),void 0),"s_jLcSz3xtGBc",[l,p]),I=m(()=>f(()=>Promise.resolve().then(()=>ve),void 0),"s_2B0rsx0vXL0",[p,T]),R=m(()=>f(()=>Promise.resolve().then(()=>_e),void 0),"s_84n07CVa0mw",[p,T]),A=m(()=>f(()=>Promise.resolve().then(()=>$),void 0),"s_fP8Vgcsq5Bs",[p,T,V]),M=m(()=>f(()=>Promise.resolve().then(()=>he),void 0),"s_ao0347qXgb4",[p,T]),z=m(()=>f(()=>Promise.resolve().then(()=>we),void 0),"s_k75Yd00jBcM",[s,E,p,j,_,a,c,u,r]);return S(m(()=>f(()=>Promise.resolve().then(()=>re),void 0),"s_uQEGtKH23FI",[L,p,c,T,D])),S(m(()=>f(()=>Promise.resolve().then(()=>le),void 0),"s_1eiAyh0j7U0",[M,I,R,A,a,c])),e.value.techniques.length===0?o("div",null,{class:"fixed inset-0 z-[9999] bg-black flex items-center justify-center p-4 font-sans"},o("div",null,{class:"max-w-md text-center bg-gray-900/50 backdrop-blur-xl p-8 rounded-3xl border border-white/10 shadow-2xl"},[o("div",null,{class:"text-6xl mb-6"},"âš ï¸",3,null),o("h2",null,{class:"text-2xl font-black text-white italic tracking-tighter mb-4"},"GIOCO NON DISPONIBILE",3,null),o("p",null,{class:"text-gray-400 mb-8 font-medium"},v(d=>d.value.error||"Nessuna tecnica trovata. Assicurati che il database sia attivo.",[e]),3,null),o("button",null,{class:"px-8 py-3 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl transition-all hover:scale-105 active:scale-95 uppercase tracking-wider",onClick$:m(()=>f(()=>Promise.resolve().then(()=>Ie),void 0),"s_UPylkDwg3ek",[n])},"Torna alla Home",3,null)],3,null),3,"dy_3"):o("div",null,{class:"fixed inset-0 z-[9999] bg-black text-white overflow-hidden font-sans"},[o("div",null,{class:"absolute inset-0 z-0 flex items-center justify-center"},[o("img",null,{src:v((d,q)=>q.value?"/media/kano_non_sa.webp":d.image||"/media/kano_non_sa.webp",[s,_]),alt:"Background",class:"w-full h-full object-cover opacity-60 transition-opacity duration-1000",onError$:m(()=>f(()=>Promise.resolve().then(()=>je),void 0),"s_8iwDqWpSFeI",[s,_])},null,3,null),o("div",null,{class:"absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-black/80"},null,3,null)],3,null),o("div",null,{class:"absolute top-0 left-0 right-0 z-[100] p-4 flex justify-between items-start pointer-events-none"},[o("div",null,{class:"bg-black/40 backdrop-blur-md rounded-2xl p-3 border border-white/10 pointer-events-auto"},o("h2",null,{class:"text-xl font-black italic tracking-tighter text-blue-500"},["Gokyo",o("span",null,{class:"text-white"},"-Tris",3,null)],3,null),3,null),o("button",null,{class:"w-12 h-12 flex items-center justify-center bg-red-600/90 hover:bg-red-500 rounded-full border-2 border-white/20 shadow-lg transition-all active:scale-90 pointer-events-auto","aria-label":"Close",onClick$:m(()=>f(()=>Promise.resolve().then(()=>ce),void 0),"s_A6IyCQ8FTmg",[n])},o("span",null,{class:"text-2xl font-bold"},"âœ•",3,null),3,null)],3,null),o("div",null,{class:"relative z-10 w-full h-full flex flex-col items-center justify-between py-20 px-4"},[o("div",null,{class:"w-full max-w-sm grid grid-cols-3 gap-2 bg-black/50 backdrop-blur-md rounded-2xl p-4 border border-white/10 shadow-xl"},[o("div",null,{class:"flex flex-col justify-center gap-1 font-mono text-[10px]"},[o("div",null,{class:"flex justify-between border-b border-red-500/30"},[o("span",null,{class:"text-gray-400"},"IPPON",3,null),o("span",null,{class:"text-red-500 font-bold"},v(d=>d.ippon,[r]),3,null)],3,null),o("div",null,{class:"flex justify-between border-b border-yellow-500/30"},[o("span",null,{class:"text-gray-400"},"WAZA",3,null),o("span",null,{class:"text-yellow-500 font-bold"},v(d=>d.waza,[r]),3,null)],3,null),o("div",null,{class:"flex justify-between"},[o("span",null,{class:"text-gray-400"},"YUKO",3,null),o("span",null,{class:"text-blue-500 font-bold"},v(d=>d.yuko,[r]),3,null)],3,null)],3,null),o("div",null,{class:"flex flex-col items-center justify-center text-center"},[o("div",null,{class:"text-[10px] text-gray-500 uppercase tracking-widest font-bold"},"Tecnica",3,null),o("div",null,{class:"mt-1 font-bold text-xs line-clamp-2 leading-tight h-8 flex items-center"},v(d=>d.name||"---",[s]),3,null),o("div",null,{class:"text-lg text-red-500 font-serif leading-none mt-1"},v(d=>d.kanji,[s]),3,null)],3,null),o("div",null,{class:"flex flex-col items-center justify-center border-l border-white/10 pl-2"},[o("div",null,{class:"text-[10px] text-gray-400 mb-1 font-bold"},"NEXT",3,null),o("canvas",{ref:i},{width:45,height:45,class:"bg-black/20 rounded"},null,3,null)],1,null)],1,null),o("div",null,{class:"flex-grow flex items-center justify-center w-full my-4 overflow-hidden"},o("canvas",{ref:l},{width:320,height:640,class:"h-full rounded-lg border-2 border-white/20 shadow-[0_0_50px_rgba(0,0,0,0.8)] aspect-[1/2]"},null,3,null),1,null),o("div",null,{class:"w-full max-w-md flex justify-around items-center px-4"},[Q(N,{label:"MUOVI",onLeft:I,onRight:R,onDown:M,[k]:{label:k,onLeft:k,onRight:k,onDown:k}},3,"dy_4"),o("div",null,{class:"flex flex-col gap-2"},[o("button",null,{class:"w-20 h-20 bg-gradient-to-br from-red-600 to-red-800 rounded-full shadow-[0_0_20px_rgba(220,38,38,0.4)] border-4 border-white/20 active:scale-95 transition-transform flex items-center justify-center",onClick$:A},o("span",null,{class:"text-4xl font-bold select-none"},"â†»",3,null),3,null),o("span",null,{class:"text-[10px] text-center font-bold text-gray-500 uppercase tracking-widest"},"Ruota",3,null)],3,null)],1,null)],1,null),(!c.value||a.value)&&o("div",null,{class:"absolute inset-0 z-[200] bg-black/90 backdrop-blur-xl flex flex-col items-center justify-center p-8 text-center"},[o("div",null,{class:"mb-10"},[o("h1",null,{class:"text-6xl font-black italic tracking-tighter leading-none mb-2"},["GOKYO",o("br",null,null,null,3,null),o("span",null,{class:"text-red-600"},"-TRIS",3,null)],3,null),o("p",null,{class:"text-gray-500 font-medium tracking-widest uppercase text-xs"},"Judo Mastery Game",3,null)],3,null),a.value&&o("div",null,{class:"mb-12 animate-in fade-in zoom-in duration-500"},[o("div",null,{class:"text-red-600 font-black text-4xl mb-4 italic"},"IPPON!",3,null),o("div",null,{class:"bg-white/5 rounded-3xl p-6 border border-white/10 max-w-xs mx-auto"},[o("p",null,{class:"text-gray-400 text-sm mb-3 font-bold uppercase tracking-widest"},"Risultato Finale",3,null),o("div",null,{class:"grid grid-cols-3 gap-4"},[o("div",null,{class:"flex flex-col"},[o("span",null,{class:"text-2xl font-black text-red-500"},v(d=>d.ippon,[r]),3,null),o("span",null,{class:"text-[10px] text-gray-500 font-bold"},"IPPON",3,null)],3,null),o("div",null,{class:"flex flex-col"},[o("span",null,{class:"text-2xl font-black text-yellow-500"},v(d=>d.waza,[r]),3,null),o("span",null,{class:"text-[10px] text-gray-500 font-bold"},"WAZA",3,null)],3,null),o("div",null,{class:"flex flex-col"},[o("span",null,{class:"text-2xl font-black text-blue-500"},v(d=>d.yuko,[r]),3,null),o("span",null,{class:"text-[10px] text-gray-500 font-bold"},"YUKO",3,null)],3,null)],3,null)],3,null)],3,"dy_5"),o("button",null,{class:"group relative px-12 py-5 overflow-hidden rounded-full transition-all hover:scale-105 active:scale-95",onClick$:z},[o("div",null,{class:"absolute inset-0 bg-red-600 transition-colors group-hover:bg-red-500"},null,3,null),o("span",null,{class:"relative text-2xl font-black tracking-tight text-white uppercase italic"},v(d=>d.value?"Riprova":"Inizia Ora",[a]),3,null)],3,null),o("div",null,{class:"mt-12 text-gray-500 font-mono text-[10px] uppercase tracking-widest"},"Tastiera: FRECCE | Touch: JOYSTICK",3,null)],1,"dy_6"),o("style",null,{dangerouslySetInnerHTML:`
          body { overflow: hidden; overscroll-behavior: none; }
          * { -webkit-tap-highlight-color: transparent; }
        `},null,3,null)],1,"dy_7")},Ye=Object.freeze(Object.defineProperty({__proto__:null,s_IGGPJgwjw7w:pe},Symbol.toStringTag,{value:"Module"})),xe=async()=>{const[e,n]=g(),t=e.currentTetromino.col-1;await n(e.currentTetromino.matrix,e.currentTetromino.row,t,e.playfield)&&(e.currentTetromino.col=t,w.move())},ve=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_2B0rsx0vXL0:xe},Symbol.toStringTag,{value:"Module"})),be=async()=>{const[e,n]=g(),t=e.currentTetromino.row+1;await n(e.currentTetromino.matrix,t,e.currentTetromino.col,e.playfield)&&(e.currentTetromino.row=t)},he=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_ao0347qXgb4:be},Symbol.toStringTag,{value:"Module"})),ye=async()=>{const[e,n,t,l,i,c,a,r,u]=g();if(w.init(),t.playfield=Array.from({length:y},()=>Array(b).fill(0)),t.tetrominoSequence=[],t.count=0,t.nextTetromino=await l(),t.currentTetromino=await l(),await n(),t.currentTetromino.techData){const s=t.currentTetromino.techData,_=s.image.startsWith("http")?s.image:`/media/${s.image}`;e.name=s.name,e.kanji=s.kanji||"",e.image=_,i.value=!1}u.ippon=0,u.waza=0,u.yuko=0,r.value=1,c.value=!1,a.value=!0},we=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_k75Yd00jBcM:ye},Symbol.toStringTag,{value:"Module"})),Te=()=>{const[e,n,t]=g();e.requestId&&cancelAnimationFrame(e.requestId),n.value=!0,t.value=!1},ke=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_0DpCYMKNlc4:Te},Symbol.toStringTag,{value:"Module"})),Oe=async()=>{const[e,n,t,l,i,c,a]=g(),{currentTetromino:r}=t;if(!r)return;for(let s=0;s<r.matrix.length;s++)for(let _=0;_<r.matrix[s].length;_++)if(r.matrix[s][_]){if(r.row+s<0)return await c();t.playfield[r.row+s][r.col+_]=r.color}let u=0;for(let s=y-1;s>=0;)t.playfield[s].every(_=>!!_)?(u++,t.playfield.splice(s,1),t.playfield.unshift(new Array(b).fill(0))):s--;if(u>0?(w.lineClear(),await a(u)):w.drop(),t.currentTetromino=t.nextTetromino,t.nextTetromino=await l(),t.currentTetromino.techData){const s=t.currentTetromino.techData,_=s.image.startsWith("http")?s.image:`/media/${s.image}`;e.name=s.name,e.kanji=s.kanji||"",e.image=_,i.value=!1}await n()},Se=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_uRuNYoAq4dI:Oe},Symbol.toStringTag,{value:"Module"})),Pe=()=>{const[e,n]=g();e.image!=="/media/kano_non_sa.webp"&&(e.image="/media/kano_non_sa.webp",n.value=!0)},je=Object.freeze(Object.defineProperty({__proto__:null,s_8iwDqWpSFeI:Pe},Symbol.toStringTag,{value:"Module"})),Ee=()=>{const[e]=g();return e("/")},Ie=Object.freeze(Object.defineProperty({__proto__:null,s_UPylkDwg3ek:Ee},Symbol.toStringTag,{value:"Module"})),Re=()=>{const[e]=g();e.sectionTitle="Gokyo-Tris",e.sectionIcon="ðŸ•¹ï¸"},Ae=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_rwlw60gLUfE:Re},Symbol.toStringTag,{value:"Module"})),Me=async()=>{const[e,n,t]=g();n.tetrominoSequence.length===0&&await t();const l=n.tetrominoSequence.pop(),i=C[l],c=Math.floor(b/2)-Math.ceil(i[0].length/2),a=l==="I"?-1:0;let r=1;switch(l){case"L":r=2;break;case"I":r=3;break;case"O":r=1;break;case"J":r=4;break;case"T":r=5;break;case"S":r=2;break;case"Z":r=1;break}const u=Y[r];let s=null;if(e.value.techniques.length>0){const _=e.value.techniques.filter(p=>p.group===u.name);_.length>0&&(s=_[Math.floor(Math.random()*_.length)])}return{name:l,matrix:i,row:a,col:c,color:u.color,gokyoGroup:r,techData:s}},Ve=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_QsZ56tfQOvY:Me},Symbol.toStringTag,{value:"Module"}));export{x as _hW,Ye as i,Te as s_0DpCYMKNlc4,oe as s_1eiAyh0j7U0,xe as s_2B0rsx0vXL0,ue as s_84n07CVa0mw,Pe as s_8iwDqWpSFeI,ie as s_A6IyCQ8FTmg,pe as s_IGGPJgwjw7w,ae as s_K1oWgheaAWg,Me as s_QsZ56tfQOvY,U as s_RAVO7De0lxE,Ee as s_UPylkDwg3ek,de as s_a9pNKgRJGHg,be as s_ao0347qXgb4,ee as s_el01Rh6rz00,Z as s_fP8Vgcsq5Bs,X as s_jLcSz3xtGBc,ye as s_k75Yd00jBcM,Re as s_rwlw60gLUfE,ne as s_uQEGtKH23FI,Oe as s_uRuNYoAq4dI,fe as s_vNVkVuqtQ54};
